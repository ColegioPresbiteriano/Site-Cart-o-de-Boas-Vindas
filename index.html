<!DOCTYPE html>
<!--
  Projeto: Volta às Aulas (Colégio Presbiteriano)
  Autor/Desenvolvedor: Diego Lima de Oliveira
  Contato: diegolima.dev@outlook.com | https://github.com/diegodromer
  Copyright © 2025 Diego Lima de Oliveira. Todos os direitos reservados.
  Licença: LicenseRef-Proprietary (uso autorizado pelo Colégio).
  SPDX-License-Identifier: LicenseRef-Proprietary
-->
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <title>Volta às Aulas</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      min-height: 100dvh;
      height: 100%;
      font-family: 'Segoe UI', sans-serif;
      background: #000;
    }


    .container {
      display: flex;
      flex-direction: column;
      flex-wrap: wrap;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }
    }

    .start-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100dvh;
      background: #CDEDFE;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }


    .start-screen img {
      width: 220px;
      cursor: pointer;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
        opacity: 1;
      }

      50% {
        transform: scale(1.05);
        opacity: 0.85;
      }

      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    .card {
      background-image: url('school-building.gif'), linear-gradient(to bottom, rgba(135, 206, 250, 0.4), rgba(0, 123, 255, 0.35));
      background-repeat: no-repeat;
      background-position: center top;
      background-size: contain;
      height: 100vh;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 20px;
      padding-top: 110px;
      animation: fadeIn 2s ease-in-out;
      position: relative;
      z-index: 1;
      color: white;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));
      z-index: 0;
    }

    .card>* {
      position: relative;
      z-index: 1;
    }

    h1 {
      font-size: 2.7em;
      color: #fff;
      text-shadow: 3px 3px 12px rgba(0, 0, 0, 0.85);
      animation: slideIn 1s ease-in-out;
    }

    p {
      font-size: 1.25em;
      margin: 20px 0;
      color: white;
      text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
    }

    .btn-link {
      background-color: #bf0811;
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 8px;
      font-size: 17px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
      box-shadow: 0 4px 14px rgba(191, 8, 17, 0.7);
    }

    .btn-link:hover {
      background-color: #8f060e;
      box-shadow: 0 6px 18px rgba(143, 6, 14, 0.7);
    }

    .logo-esquerda,
    .logo-instituicao {
      position: fixed;
      bottom: 10px;
      width: 100px;
      opacity: 0.35;
      pointer-events: none;
      user-select: none;
      z-index: 9999;
      filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.4));
    }

    .logo-instituicao {
      right: 10px;
      width: 150px;
    }

    .logo-esquerda {
      left: 10px;
    }

    .animated-wheel {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      width: 200vw;
      height: 200vh;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      background: repeating-conic-gradient(#E2F3FF 0deg 15deg, #C5EBFC 15deg 30deg);
      animation: girarRoleta 30s linear infinite;
      opacity: 1;
      z-index: 0;
      pointer-events: none;
    }

    .fade-out {
      opacity: 0;
      transition: opacity 2s ease;
    }

    .texto-container {
      background: rgba(0, 0, 0, 0.30);
      padding: 24px 28px;
      border-radius: 24px;
      box-shadow: 0 12px 36px rgba(0, 0, 0, 0.35);
      max-width: 92%;
      margin: 0 auto;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      animation: fadeUp 1s ease-out forwards;
      opacity: 0;
      transform: translateY(20px);
    }

    @keyframes fadeUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .texto-container h1,
    .texto-container p {
      color: #fff;
      text-shadow: 2px 3px 6px rgba(0, 0, 0, 0.85);
    }

    #audio-control {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.75);
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      color: #333;
      display: none;
      z-index: 10;
      user-select: none;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    canvas#confetti-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1000;
    }

    #video-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      display: none;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.88);
      z-index: 11000;
      backdrop-filter: blur(5px);
    }

    #video-container {
      position: relative;
      width: 90%;
      max-width: 800px;
      background: #111;
      border-radius: 16px;
      box-shadow: 0 0 25px rgba(191, 8, 17, 0.9);
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 0.5s ease forwards;
    }

    video {
      border-radius: 12px;
      width: 100%;
      max-height: 450px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.7);
      background: black;
    }

    #video-controls {
      margin-top: 10px;
      width: 100%;
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    #close-video,
    #fullscreen-video {
      cursor: pointer;
      background: #bf0811;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      font-weight: bold;
      color: white;
      font-size: 14px;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    #close-video:hover,
    #fullscreen-video:hover {
      background: #8f060e;
    }

    @keyframes balloonPop {
      0% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }

      100% {
        transform: scale(0.3) rotate(360deg);
        opacity: 0;
      }
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 2em;
      }

      p {
        font-size: 1em;
      }

      #video-container {
        max-width: 95%;
      }

      video {
        width: 100vw;
        height: auto;
        max-height: none;
        object-fit: contain;
      }
    }

    @media (orientation: landscape) and (max-width: 768px) {

      html,
      body {
        width: 100vw;
        height: 100vh;
        overflow: auto !important;
        background: #000;
      }

      #video-modal {
        display: none !important;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 100vw !important;
        height: auto !important;
        max-height: 100vh !important;
        background: #000 !important;
        padding: 10px 0;
        overflow-y: auto !important;
        box-sizing: border-box;
        z-index: 99999 !important;
      }

      #video-container {
        width: 90vw !important;
        max-width: 100% !important;
        height: auto !important;
        background: #000 !important;
        padding: 10px !important;
        border-radius: 12px !important;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow: visible !important;
      }

      video {
        width: 100% !important;
        height: auto !important;
        max-height: 60vh !important;
        object-fit: contain !important;
        border-radius: 12px !important;
      }

      #video-controls {
        position: absolute !important;
        bottom: 16px !important;
        right: 16px !important;
        width: auto !important;
        z-index: 100000 !important;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 10px;
        padding: 6px 10px;
        gap: 8px;
      }

      #close-video,
      #fullscreen-video {
        font-size: 12px !important;
        padding: 6px 10px !important;
      }

    }

    @keyframes girarRoleta {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
      }
    }

    #fullscreen-message {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.75);
      color: white;
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 16px;
      z-index: 99999;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      animation: fadeOut 2.5s forwards;
      pointer-events: none;
    }

    @keyframes fadeOut {

      0%,
      80% {
        opacity: 1;
      }

      100% {
        opacity: 0;
      }
    }

    #wrapper {
      min-height: 100dvh;
      overflow-y: auto;
    }

    body.landscape-mode #video-modal {
      display: flex !important;
      flex-direction: column !important;
      justify-content: center !important;
      align-items: center !important;
      padding: 12px 0 !important;
      height: 100dvh !important;
      overflow-y: auto !important;
    }

    body.landscape-mode #video-container {
      width: 90vw !important;
      max-width: 100vw !important;
      padding: 10px !important;
      background: #000 !important;
      border-radius: 12px !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
    }

    body.landscape-mode video {
      width: 100% !important;
      max-height: 60vh !important;
      height: auto !important;
      object-fit: contain !important;
      border-radius: 12px !important;
    }

    body.landscape-mode #video-controls {
      margin-top: 12px;
      width: 100%;
      display: flex !important;
      justify-content: flex-end;
      gap: 12px;
      position: relative !important;
      z-index: 100000;
    }

    html {
      padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
    }
  </style>

</head>

<body>
  <div id="wrapper">
    <div class="animated-wheel" id="roleta"></div>

    <img src="logo-presbiteriano.png" alt="Colégio Presbiteriano" class="logo-instituicao" />
    <img src="logo-esquerda.png" alt="Logo comemorativa 25 anos" class="logo-esquerda">

    <div class="start-screen" id="start-screen">
      <img src="presente.gif" alt="Clique para abrir" id="carta-img" onclick="abrirCarta()" />
    </div>

    <canvas id="confetti-canvas"></canvas>


    <div class="card" id="card">
      <div class="texto-container">
        <h1>Bem-vindo de volta às aulas!</h1>
        <p>Que seja um semestre de muitas conquistas e aprendizado! 🎓</p>
        <button class="btn-link" id="open-video-btn">Assista à mensagem especial 🎥</button>
      </div>
      <!-- Caso queira usar o link externo, substitua pelo abaixo e comente o botão acima -->
      <!-- <a href="https://www.youtube.com/watch?v=TZCA_X6uD10" target="_blank" class="btn-link">Assista à mensagem especial 🎥</a> -->
    </div>

    <div id="audio-control" onclick="toggleAudio()">🔊 Música</div>

    <audio id="background-audio" loop>
      <source src="uplifting-ukulele-334612.mp3" type="audio/mpeg" />
      Seu navegador não suporta áudio.
    </audio>

    <div id="video-modal" role="dialog" aria-modal="true" aria-labelledby="video-title">

      <div id="video-container">
        <video id="video-player" controls preload="metadata" playsinline>
          <source src="boasvindas.mp4" type="video/mp4" />
          Seu navegador não suporta vídeo.
        </video>

        <div id="fullscreen-message" style="display:none;">
          Tela maximizada
        </div>

        <div id="video-controls">
          <button id="fullscreen-video" aria-label="Maximizar vídeo">⤢ Maximizar</button>
          <button id="close-video" aria-label="Fechar vídeo">✕ Fechar</button>
        </div>
      </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
      let estaEmFullscreen = false;

      const audio = document.getElementById('background-audio');
      const cartaImg = document.getElementById('carta-img');
      const startScreen = document.getElementById('start-screen');
      const card = document.getElementById('card');
      const audioControl = document.getElementById('audio-control');

      const openVideoBtn = document.getElementById('open-video-btn');
      const videoModal = document.getElementById('video-modal');
      const videoPlayer = document.getElementById('video-player');
      const closeVideoBtn = document.getElementById('close-video');
      const fullscreenBtn = document.getElementById('fullscreen-video');

      function detectarLandscape() {
        const emLandscape = window.matchMedia("(orientation: landscape)").matches;
        const modalVisivel = videoModal && videoModal.style.display === 'flex';
        if (emLandscape && modalVisivel) {
          document.body.classList.add("landscape-mode");
        } else {
          document.body.classList.remove("landscape-mode");
        }
      }

      window.addEventListener("load", detectarLandscape);
      window.addEventListener("resize", detectarLandscape);
      window.addEventListener("orientationchange", detectarLandscape);

      function toggleAudio() {
        if (audio.paused) {
          audio.play();
          audioControl.innerText = "🔊 Música";
        } else {
          audio.pause();
          audioControl.innerText = "🔇 Música";
        }
      }

      function abrirCarta() {
        cartaImg.style.pointerEvents = 'none';
        cartaImg.style.animation = 'none';
        startScreen.classList.add('fade-out');
        startScreen.addEventListener('transitionend', () => {
          startScreen.style.display = 'none';
          card.style.display = 'flex';
          audioControl.style.display = 'block';
          audio.play().catch(() => { });
          launchConfetti();
          document.getElementById('roleta').style.display = 'block';
        }, { once: true });
      }

      function launchConfetti() {
        const duration = 6000;
        const animationEnd = Date.now() + duration;
        const defaults = {
          startVelocity: 25,
          spread: 55,
          ticks: 70,
          zIndex: 1000
        };

        function randomInRange(min, max) {
          return Math.random() * (max - min) + min;
        }

        const interval = setInterval(() => {
          const timeLeft = animationEnd - Date.now();
          if (timeLeft <= 0) return clearInterval(interval);

          const particleCount = 40 * (timeLeft / duration);
          confetti({
            particleCount,
            origin: {
              x: randomInRange(0.1, 0.9),
              y: Math.random() * 0.6
            },
            colors: ['#f39c12', '#f1c40f', '#e67e22', '#d35400', '#f39c12'],
            ...defaults
          });
        }, 200);
      }

      async function sairDoFullscreen() {
        return new Promise(resolve => {
          if (document.exitFullscreen) document.exitFullscreen();
          else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
          else if (document.msExitFullscreen) document.msExitFullscreen();

          const check = () => {
            if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {
              resolve();
            } else {
              setTimeout(check, 50);
            }
          };
          check();
        });
      }

      async function fecharModal() {
        try {
          await sairDoFullscreen();
        } catch (e) { }

        videoModal.classList.remove('fade-in');
        videoModal.classList.add('fade-out');

        setTimeout(() => {
          videoModal.style.display = 'none';
          videoModal.classList.remove('fade-out');
          videoPlayer.pause();
          videoPlayer.currentTime = 0;
          document.body.style.overflow = 'auto';
          document.body.classList.remove("landscape-mode");
          audio.play().catch(() => { });

          // Reset for edge case where browser re-maximizes parent element
          setTimeout(() => {
            if (document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
              sairDoFullscreen();
            }
          }, 200);

        }, 600);
      }

      openVideoBtn.addEventListener('click', () => {
        videoModal.style.display = 'flex';
        videoModal.classList.add('fade-in');
        videoModal.classList.remove('fade-out');
        videoPlayer.currentTime = 0;
        videoPlayer.play();
        audio.pause();
        launchConfetti();
        document.body.style.overflow = 'hidden';

        // 🔧 Adicional para corrigir landscape no iOS
        setTimeout(() => {
          detectarLandscape(); // força aplicação correta de classe CSS
        }, 300); // pode ajustar o delay se necessário
      });

      closeVideoBtn.addEventListener('click', fecharModal);

      window.addEventListener('keydown', (e) => {
        if (e.key === "Escape" && videoModal.style.display === 'flex') {
          fecharModal();
        }
      });

      fullscreenBtn.addEventListener('click', () => {
        const container = videoModal;
        const isFullscreen =
          document.fullscreenElement === container ||
          document.webkitFullscreenElement === container ||
          document.msFullscreenElement === container;

        if (!isFullscreen) {
          if (container.requestFullscreen) container.requestFullscreen();
          else if (container.webkitRequestFullscreen) container.webkitRequestFullscreen();
          else if (container.msRequestFullscreen) container.msRequestFullscreen();
        } else {
          sairDoFullscreen();
        }
      });

      function atualizarEstadoFullscreen() {
        estaEmFullscreen = !!(
          document.fullscreenElement ||
          document.webkitFullscreenElement ||
          document.msFullscreenElement
        );
      }

      document.addEventListener('fullscreenchange', () => {
        atualizarEstadoFullscreen();
        const msg = document.getElementById('fullscreen-message');
        const isFullscreen = !!document.fullscreenElement;
        msg.innerText = isFullscreen ? "Tela maximizada" : "Tela minimizada";
        msg.style.display = 'block';
        msg.style.opacity = '1';
        msg.style.animation = 'none';
        void msg.offsetWidth;
        msg.style.animation = 'fadeOut 2.5s forwards';

        setTimeout(() => {
          msg.style.display = 'none';
        }, 2500);
      });

      document.addEventListener('webkitfullscreenchange', atualizarEstadoFullscreen);
      document.addEventListener('MSFullscreenChange', atualizarEstadoFullscreen);

      videoPlayer.addEventListener('pause', () => {
        if (videoModal.style.display === 'flex') {
          audio.play().catch(() => { });
        }
      });

      videoPlayer.addEventListener('ended', () => {
        if (videoModal.style.display === 'flex') {
          audio.play().catch(() => { });
        }
      });

      document.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => {
          const emLandscape = window.matchMedia("(orientation: landscape)").matches;
          const modalVisivel = videoModal && videoModal.style.display === 'flex';

          if (emLandscape && modalVisivel) {
            document.body.classList.add("landscape-mode");
          }
        }, 100); // delay mínimo para garantir estilo aplicado após render
      });

    </script>

  </div>
</body>


</html>
